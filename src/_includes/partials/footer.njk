<footer class="rim-footer">
  <div class="rim-footer-inner">

    <!-- Newsletter ‚Äî first in DOM = first on mobile -->
    {% if not memberArea %}
    <div class="rim-footer-col rim-footer-newsletter">
      <div class="rim-footer-heading">Stay Connected</div>
      <form class="footer-subscribe-form" id="footer-subscribe-form" novalidate>
        <input type="text"  name="first_name" placeholder="First name"    class="footer-input">
        <input type="email" name="email"      placeholder="Email address" class="footer-input" required>
        <button type="submit" class="footer-subscribe-btn">Subscribe</button>
        <p class="footer-subscribe-msg" id="footer-subscribe-msg" hidden></p>
      </form>
    </div>
    {% endif %}

    <!-- Contact -->
    <div class="rim-footer-col rim-footer-contact">
      <img src="/images/RIM-Website-Footer-Logo-White.png" alt="Rooted In Mindfulness" width="65" class="rim-footer-logo">
      <div class="rim-footer-address">
        Rooted In Mindfulness<br>
        4040 N. Calhoun Rd.<br>
        Brookfield, WI, 53005
      </div>
      <div class="rim-footer-contact-links">
        <a href="tel:4148828932">(414) 882-8932</a>
        <a href="mailto:support@rootedinmindfulness.org?subject=Dear%20RIM%20Support">support@rootedinmindfulness.org</a>
      </div>
    </div>

    <!-- Explore links -->
    <div class="rim-footer-col rim-footer-links">
      <div class="rim-footer-heading">Explore</div>
      <a href="/community-programs">Programs</a>
      <a href="/donate">Donate</a>
      <a href="/volunteerism/volunteer">Volunteer</a>
      <a href="/community-membership">Join RIM</a>
      <a href="/kalyana-mitta/community-groups-events">Community Groups</a>
    </div>

  </div>

  <div class="rim-footer-bottom">
    <span>¬©2020 Rooted In Mindfulness | 501(c)(3) Non-Profit | <a href="/donate">Donate</a></span>
    <span>Powered by Kind People :) <a href="/volunteerism/volunteer">Volunteer</a></span>
  </div>
</footer>

{% if not memberArea %}
<script>
(function () {
  var form = document.getElementById('footer-subscribe-form');
  if (!form) return;

  form.addEventListener('submit', async function (e) {
    e.preventDefault();
    var msg = document.getElementById('footer-subscribe-msg');
    var btn = form.querySelector('button[type="submit"]');
    var email = form.email.value.trim();

    if (!email) {
      msg.textContent = 'Please enter your email address.';
      msg.hidden = false;
      return;
    }

    btn.disabled = true;
    btn.textContent = 'Subscribing‚Ä¶';
    msg.hidden = true;

    try {
      var res = await fetch('/api/subscribe', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email: email, first_name: form.first_name.value.trim() })
      });

      var data = await res.json();

      if (res.ok) {
        form.innerHTML = '<p class="footer-subscribe-msg footer-subscribe-success">Thank you! You\'re on the list. üôè</p>';
      } else {
        msg.textContent = data.error || 'Something went wrong. Please try again.';
        msg.hidden = false;
        btn.disabled = false;
        btn.textContent = 'Subscribe';
      }
    } catch (err) {
      msg.textContent = 'Something went wrong. Please try again.';
      msg.hidden = false;
      btn.disabled = false;
      btn.textContent = 'Subscribe';
    }
  });
}());
</script>
{% endif %}

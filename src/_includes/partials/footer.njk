<div class="footer">
  <div class="container-7">
    <div class="footer-top-row">

      <!-- Newsletter first in DOM so it stacks first on mobile -->
      {% if not memberArea %}
      <div class="footer-col-newsletter">
        <div class="footer-links-header">Stay Connected</div>
        <form class="footer-subscribe-form" id="footer-subscribe-form" novalidate>
          <input type="text"  name="first_name" placeholder="First name"     class="footer-input">
          <input type="email" name="email"      placeholder="Email address"  class="footer-input" required>
          <button type="submit" class="footer-subscribe-btn">Subscribe</button>
          <p class="footer-subscribe-msg" id="footer-subscribe-msg" hidden></p>
        </form>
      </div>
      {% endif %}

      <!-- Logo + Contact -->
      <div class="footer-logo-column">
        <img src="/images/RIM-Website-Footer-Logo-White.png" height="" alt="Rooted In Mindfulness" width="75" class="footer-logo">
        <div class="footer-address">Rooted In Mindfulness<br>4040 N. Calhoun Rd.<br>Brookfield, WI, 53005</div>
        <div class="footer-links-phone-email">
          <div class="footer-telephone">
            <a href="tel:4148828932" class="link">(414) 882-8932</a>
          </div>
          <a href="mailto:support@rootedinmindfulness.org?subject=Dear%20RIM%20Support" class="footer-link-email">support@rootedinmindfulness.org</a>
        </div>
      </div>

      <!-- Explore links -->
      <div class="footer-col-explore">
        <div class="footer-links-header">Explore</div>
        <a href="/community-programs" class="footer-links-main">Programs</a>
        <a href="/donate" class="footer-links-main">Donate</a>
        <a href="/volunteerism/volunteer" class="footer-links-main">Volunteer</a>
        <a href="/community-membership" class="footer-links-main">Join RIM</a>
        <a href="/kalyana-mitta/community-groups-events" class="footer-links-main">Community Groups</a>
      </div>

    </div>

    <div class="footer-bottom-row">
      <div class="small-text-2">¬©2020 Rooted In Mindfulness | 501(c)(3) Non-Profit | <a href="/donate" target="_blank" class="link-3">Donate</a></div>
      <div class="small-text-2">Powered by Kind People :) <a href="/volunteerism/volunteer" class="link-2">Volunteer</a></div>
    </div>
  </div>
</div>

{% if not memberArea %}
<script>
(function () {
  var form = document.getElementById('footer-subscribe-form');
  if (!form) return;

  form.addEventListener('submit', async function (e) {
    e.preventDefault();
    var msg = document.getElementById('footer-subscribe-msg');
    var btn = form.querySelector('button[type="submit"]');
    var email = form.email.value.trim();

    if (!email) {
      msg.textContent = 'Please enter your email address.';
      msg.hidden = false;
      return;
    }

    btn.disabled = true;
    btn.textContent = 'Subscribing‚Ä¶';
    msg.hidden = true;

    try {
      var res = await fetch('/api/subscribe', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          email: email,
          first_name: form.first_name.value.trim()
        })
      });

      var data = await res.json();

      if (res.ok) {
        form.innerHTML = '<p class="footer-subscribe-msg footer-subscribe-success">Thank you! You\'re on the list. üôè</p>';
      } else {
        msg.textContent = data.error || 'Something went wrong. Please try again.';
        msg.hidden = false;
        btn.disabled = false;
        btn.textContent = 'Subscribe';
      }
    } catch (err) {
      msg.textContent = 'Something went wrong. Please try again.';
      msg.hidden = false;
      btn.disabled = false;
      btn.textContent = 'Subscribe';
    }
  });
}());
</script>
{% endif %}
